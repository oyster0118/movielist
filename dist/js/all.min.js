angular.module("myApp",["ngRoute","in_theatersCtrlModule","myServiceModule","coming_soonCtrlModule","searchCtrlModule","top250CtrlModule"]).controller("commonCtrl",["$scope","$location",function(e,o){e.jump=function(){alert(e.keyword),o.path("/search/1/"+e.keyword)}}]).config(["$routeProvider","$sceDelegateProvider",function(e,o){e.when("/in_theaters/:page",{templateUrl:"./views/in_theaters/in_theaters.html",controller:"in_theatersCtrl"}).when("/coming_soon/:page",{templateUrl:"./views/coming_soon/coming_soon.html",controller:"coming_soonCtrl"}).when("/search/:page/:keyword",{templateUrl:"./views/search/search.html",controller:"searchCtrl"}).when("/top250/:page",{templateUrl:"views/top250/top250.html",controller:"top250Ctrl"}).otherwise("/in_theaters/1"),o.resourceUrlWhitelist(["self"])}]),angular.module("myServiceModule",[]).service("myService",[function(){this.myJsonp=function(e,o,t){var r="myJsonp_"+Math.random().toString().replace(".","");window[r]=t;var n="";for(var a in o)n+=a+"="+o[a]+"&";var l=document.createElement("script");l.src=e+"?"+n+"callback="+r,l.onload=function(){document.body.removeChild(l)},document.body.appendChild(l)}}]),angular.module("coming_soonCtrlModule",[]).controller("coming_soonCtrl",["$scope","$http","myService","$routeParams","$location",function(e,o,t,r,n){var a=Number(r.page),l=10*(a-1),c=0;t.myJsonp("https://api.douban.com/v2/movie/coming_soon",{count:10,start:l},function(o){e.result=o,c=Math.ceil(o.total/10),e.$apply(),console.log(o)}),e.changePage=function(e){"prev"==e?((a-=1)<1&&(a=1),alert(a)):"next"==e&&((a+=1)>c&&(a=c),alert(a)),n.path("/coming_soon/"+a)}}]),angular.module("in_theatersCtrlModule",[]).controller("in_theatersCtrl",["$scope","$http","myService","$routeParams","$location",function(e,o,t,r,n){var a=Number(r.page),l=10*(a-1),c=0;t.myJsonp("https://api.douban.com/v2/movie/in_theaters",{count:10,start:l},function(o){e.result=o,c=Math.ceil(o.total/10),e.$apply(),console.log(o)}),e.changePage=function(e){"prev"==e?((a-=1)<1&&(a=1),alert(a)):"next"==e&&((a+=1)>c&&(a=c),alert(a)),n.path("/in_theaters/"+a)}}]),angular.module("searchCtrlModule",[]).controller("searchCtrl",["$scope","$http","myService","$routeParams","$location",function(e,o,t,r,n){var a=Number(r.page),l=10*(a-1),c=0,i=r.keyword;t.myJsonp("https://api.douban.com/v2/movie/search",{count:10,start:l,q:i},function(o){e.result=o,c=Math.ceil(o.total/10),e.$apply(),console.log(o)}),e.changePage=function(e){"prev"==e?((a-=1)<1&&(a=1),alert(a)):"next"==e&&((a+=1)>c&&(a=c),alert(a)),n.path("/search/"+a+"/"+i)}}]),angular.module("top250CtrlModule",[]).controller("top250Ctrl",["$scope","$location","$routeParams","myService",function(e,o,t,r){var n=Number(t.page),a=10*n-10,l=0;r.myJsonp("https://api.douban.com/v2/movie/top250",{start:a,count:10},function(o){console.log(o),e.result=o,l=Math.ceil(o.total/10),e.$apply()}),e.changePage=function(e){"up"==e?(n-=1)<1&&(n=1):"down"==e&&(n+=1)>l&&(n=l),o.path("/top250/"+n)}}]);